# Default values for rjmx-exporter.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Number of replicas
replicaCount: 1

image:
  repository: rjmx-exporter
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

service:
  type: ClusterIP
  port: 9090
  targetPort: 9090
  annotations: {}

# Resource limits and requests
# These are tuned for rJMX-Exporter's low resource footprint
resources:
  limits:
    cpu: 100m
    memory: 50Mi
  requests:
    cpu: 50m
    memory: 20Mi

nodeSelector: {}

tolerations: []

affinity: {}

# rJMX-Exporter configuration
config:
  # Server configuration
  server:
    port: 9090
    path: "/metrics"

  # Jolokia targets to scrape
  targets:
    - url: "http://localhost:8778/jolokia"
      name: "my-java-app"

  # Metric transformation rules
  rules:
    - pattern: "java.lang<type=Memory><HeapMemoryUsage>(\\w+)"
      name: "jvm_memory_heap_$1_bytes"
      type: gauge
    - pattern: "java.lang<type=Memory><NonHeapMemoryUsage>(\\w+)"
      name: "jvm_memory_nonheap_$1_bytes"
      type: gauge
    - pattern: "java.lang<type=Threading><>(\\w+)"
      name: "jvm_threads_$1"
      type: gauge
    - pattern: "java.lang<type=GarbageCollector,name=([^>]+)><>(\\w+)"
      name: "jvm_gc_$2"
      type: counter
      labels:
        gc: "$1"

# Jolokia credentials (optional)
# If set, these will be stored in a Kubernetes Secret
jolokiaAuth:
  enabled: false
  username: ""
  password: ""

# Probes configuration
probes:
  liveness:
    enabled: true
    path: /health
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  readiness:
    enabled: true
    path: /health
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

# Prometheus ServiceMonitor (requires Prometheus Operator)
serviceMonitor:
  enabled: false
  namespace: ""
  interval: 30s
  scrapeTimeout: 10s
  # Scheme for scraping metrics (http or https)
  scheme: http
  # TLS configuration for HTTPS scraping
  # Example:
  #   tlsConfig:
  #     insecureSkipVerify: true
  # Or with CA certificate:
  #   tlsConfig:
  #     ca:
  #       secret:
  #         name: my-ca-secret
  #         key: ca.crt
  tlsConfig: {}
  labels: {}
  annotations: {}

# Additional environment variables
extraEnv: []
# - name: RUST_LOG
#   value: "info"

# Additional volume mounts
extraVolumeMounts: []

# Additional volumes
extraVolumes: []
